<div class="lg:w-3/4 mx-auto space-y-8">
  <% @posts.each do |post| %>
    <div class="bg-white rounded-lg shadow-md overflow-hidden max-w-2xl mx-auto"> <!-- Added max-w-2xl to limit width -->
      <!-- User Info Section -->
      <div class="flex items-center justify-between p-4 border-b border-gray-200">
        <div class="flex items-center">
          <% if post.user.photo.attached? %>
            <%= image_tag post.user.photo, class: "w-10 h-10 rounded-full mr-3" %>
          <% else %>
            <div class="w-10 h-10 rounded-full bg-gray-300 text-white flex items-center justify-center mr-3 font-bold">
              <%= post.user.email.split('@').first[0].capitalize %>
            </div>
          <% end %>
          <div>
            <div class="font-bold text-lg">
              <%= post.user.email.split('@').first.capitalize %>
            </div>
            <div class="text-gray-500 text-sm">Location</div> <!-- Optional location field -->
          </div>
        </div>
        
        <!-- Edit/Delete actions -->
        <% if post.user == current_user %>
          <div class="flex space-x-2">
            <%= link_to edit_post_path(post.id), class: 'text-gray-800 hover:text-blue-500' do %>
            <svg class="w-6 h-6" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
              <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m14.304 4.844 2.852 2.852M7 7H4a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h11a1 1 0 0 0 1-1v-4.5m2.409-9.91a2.017 2.017 0 0 1 0 2.853l-6.844 6.844L8 14l.713-3.565 6.844-6.844a2.015 2.015 0 0 1 2.852 0Z"/>
            </svg>
          <% end %>

            <%= link_to post_path(post.id), method: :delete, data: { turbo_method: :delete, confirm: 'Are you sure?' }, class: 'text-gray-800 hover:text-red-500' do %>
              <svg class="w-6 h-6" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 7h14m-9 3v8m4-8v8M10 3h4a1 1 0 0 1 1 1v3H9V4a1 1 0 0 1 1-1ZM6 7h12v13a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7Z"/>
              </svg>
            <% end %>


          </div>
        <% end %>
      </div>

      <!-- Post Image Section -->
      <div class="px-4 pb-4">
        <%= image_tag post.photo, class: 'max-w-full h-auto rounded-lg' if post.photo.attached? %>
      </div>

      <!-- Post Description Section -->
      <div class="p-4">
        <p class="text-gray-700 mb-2">
          <span class="font-bold"><%= post.user.email.split('@').first %></span>
          <span><%= post.description %></span>
        </p>
      </div>

      <!-- Post Actions -->
      <div class="flex items-center justify-between px-4 py-2 border-t border-gray-200">
        <div class="flex items-center space-x-4">
          <%= render partial: 'likes', locals: {post: post} %>
          <span class= 'hover:text-blue-500'>
            <%= link_to 'Comment', url: post_comments_path(post), method: :post do %>
              <!-- Icon for Comment can be added here -->
            <% end %>
          </span>
        </div>
      </div>

      <!-- Comments Section -->
      <%= turbo_frame_tag "comments_for_post_#{post.id}" do %>

      <div class="px-4">
        <% post.comments.each do |comment| %>
        <%= turbo_frame_tag dom_id(comment) do %>
          <div class="flex justify-between items-center border-b border-gray-200 py-2">
            <div class="text-gray-700">
              <strong><%= comment.user.email.split('@').first.capitalize %></strong> <%= comment.comment %>
            </div>
            <%= link_to 'Delete', post_comment_path(post_id: post.id, id: comment.id), method: :delete, data: { turbo_method: :delete }, class: 'text-red-500 hover:text-red-700' %>
          </div>
        <% end %>
        <% end %>
      </div>
      <% end %>


      <!-- Comment Form -->
      <%= turbo_frame_tag "new_comment_for_post_#{post.id}" do %>

      <div class="px-4 pb-4">
        <%= simple_form_for Comment.new, url: post_comments_path(post), method: :post, data: { turbo_frame: "comments_for_post_#{post.id}" } do |f| %>
          <div class="flex items-center">
            <%= f.input :comment, label: false, placeholder: 'Add a comment...', input_html: { class: 'border border-gray-300 rounded-lg p-2 flex-grow resize-none' } %>
            <%= f.submit 'Post', class: 'bg-blue-500 text-white rounded-lg px-4 py-1 ml-2' %>
          </div>
        <% end %>
      </div>
      <% end %>
    </div>
  <% end %>
</div>
